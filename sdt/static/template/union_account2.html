<!DOCTYPE html>{% load static %}<html lang="zh"><head>    <meta charset="UTF-8">    <title>俱乐部账户</title>    <!--<link rel="stylesheet" href="../semantic/semantic.min.css"> -->    <link rel="stylesheet" href="{% static 'semantic/semantic.css'%}"><script src="http://lib.baomitu.com/jquery/1.12.4/jquery.min.js"></script><script src="http://lib.baomitu.com/datatables/1.10.16/js/jquery.dataTables.min.js"></script><script src="http://lib.baomitu.com/datatables/1.10.16/js/dataTables.semanticui.min.js"></script><script src="http://lib.baomitu.com/semantic-ui/2.2.13/semantic.min.js"></script></head><body><div id="sidebar" ></div><div class="dimmed pusher">    <div class="ui labeled icon button" id="menu">		<i class="sidebar icon"></i>		导航		</div>    <div class="ui doubling stackable container" style="padding: 50px">        <div class="ui five item inverted menu">		<a class="item" id="a">出纳台</a>		<a class="item" id="b">玩家管理</a>		<a class="item" id="c">牌局管理</a>		<a class="item" id="d">实时报表</a>		<a class="item" id="e">俱乐部管理</a>		</div>        <div class="ui horizontal divider">	    俱乐部账单	    </div>        <div class="ui small modal" id="err_message">        <h2 class="header">错误信息</h2>        <div class="content">            <p id="msg"></p>        </div>        <div class="actions">            <button class="ui negative button">返回</button>        </div>        </div>    <div class="ui doubling stackable grid">        <div class="row">            <div class="four wide column">            <h3 class="ui orange header">                <i class="credit card alternative icon"></i>                <div class="content">                    <div class="sub orange header">俱乐部账户</div>                </div>            </h3>            <div name="account_list" id="account_list">                <div class="ui form" name="cash_form" id="cash_form" >                    <div class="field">                    <label>请选择俱乐部</label>                    <select class="ui fluid search selection dropdown" name="club" id="club">                        <i class="dropdown icon"></i>                        <option class="item" value="">请选择俱乐部</option>                        {% for t in tb_club %}                        <option class="item" value={{ t.0 }},{{ t.1 }}>{{ t.2 }}</option>                        {% endfor %}                    </select>                    </div>                    <div class="field">                        <label>请选择账户</label>                        <select class="ui fluid selection dropdown" name="account" id="account">                            <i class="dropdown icon"></i>                            <option class="item" value="">请选择账户</option>                            {% for t in tb_account %}                                <option class="item" value={{ t.account_id }}>{{ t.account_desc }}</option>                            {% endfor %}                        </select>                    </div>                    <div class="field">                        <label>请输入金额</label>                        <input type="text" id="cash_num" placeholder="输入存取款金额">                    </div>                    <div class="field">                        <label>备注</label>                        <input type="text" name="note" id="note">                    </div>                    <div class="ui hidden divider"></div>                    <button class="ui mini button positive" onclick="cash()">充值</button>                    <button class="ui mini button negative right floated" onclick="cash_out_check()">结算</button>                </div>                <div class="ui horizontal divider">客服账户信息</div>                <div id="club_account">                </div>            </div>            </div>            <div class="twelve wide column" id="content">                <div id="union_content"></div>                <div class="ui horizontal divider">托管俱乐部账单</div>                <div id="developer_content"></div>            </div>        </div>    </div>    </div><div class="ui basic small modal" id="message">    <div class="header">        操作信息    </div>    <div class="content" >        <p id="msg2"></p>    </div>    <div class="actions">    <button class="ui green ok inverted button">确认</button>    </div></div><div class="ui basic small modal" id="message_cashout">    <div class="header">        操作信息    </div>    <div class="content" >        <p id="msg3"></p>    </div>    <div class="actions">    <div class="ui red basic cancel inverted button">      <i class="remove icon"></i>      取消    </div>    <button class="ui green ok inverted button" onclick="cash_out()">      <i class="checkmark icon"></i>      确认    </button>  </div></div></div><script>    	$(document).ready(function(){		$("#menu").click(function(){		    $('.ui.sidebar').sidebar('toggle');	});		$("#sidebar").load('/loadsidebar/');        $("#e").addClass('active red item');        $(".ui.dropdown").dropdown();                $("#union_content").load("/union_balance_view/ #content",function (result) {                        $result = $(result);                        $result.find("script").appendTo('#content');                    });        $("#developer_content").load('/developer_balance_view/ #content',function (result) {            $result = $(result);            $result.find("script").appendTo('#content');        });        $("#club_account").load("/club_account_info/");	}					 )</script><script>    function cash() {        var message=$("#cash_form").form('is valid');        if (message==true)        {var str_club_info=$('#club').dropdown('get value');        var club_info=str_club_info.split(",");        var club_id=club_info[0];        var club_account_id=club_info[1];        var club_name=$('#club').dropdown('get text');        var account_id=$('#account').dropdown('get value');        var cash_num=$.trim($('#cash_num').val());        var cash_type=false;        var note=$.trim($('#note').val());        if (club_account_id!='None') {            $.ajax({                url: '/club_cash/',                type: 'post',                data: {                    'club_id': club_id,                    'account_id': account_id,                    'cash_num': cash_num,                    'cash_type': cash_type,                    'note': note                },                success: function (result_2) {                    if (result_2 === "True") {                        $('#msg2').text("存款成功");                        $('#message').modal('show');                        $('#union_balance').remove();                        $("#union_content").load("/union_balance_view/ #content", function (result) {                            $result = $(result);                            $result.find("script").appendTo('#content');                            $('#cash_num').val("");                            $('#note').val("");                        });                        $("#club_account").load("/club_account_info/");                    }                }            })        }        else if(club_account_id=='None')        {            $.ajax({                url:'/developer_balance_cash/',                type:'post',                data:{'developer_id':club_id,'chance':cash_num,'note':note,'type_id':1004,'account_id':account_id},                success:function (result) {                    if(result==='True')                    {                        $('#msg2').text("存款成功");                        $('#message').modal('show');                        $('#union_balance').remove();                        $("#developer_content").load('/developer_balance_view/ #content',function (result) {                            $result = $(result);                            $result.find("script").appendTo('#content');                            $('#cash_num').val("");                            $('#note').val("");                        });                        $("#club_account").load("/club_account_info/");                    }                    else {                        $('#msg2').text("存款失败");                        $('#message').modal('show');                    }                }            })        }        }        else {            alert("请填写正确信息")        }        }    function cash_out_check() {        var message=$("#cash_form").form('is valid');        if(message===true)        {            var club_name=$('#club').dropdown('get text');            var cash_num=$.trim($('#cash_num').val());            var account=$('#account').dropdown('get text');            var info="确认由(" + account + ")账户给俱乐部【" + club_name + "】结算" + cash_num + "吗？";            $('#msg3').text(info);            $('#message_cashout').modal('show');        }        else {            alert("请填写正确信息")        }    }    function cash_out() {        var message=$("#cash_form").form('is valid');        if (message===true)        {            var str_club_info=$('#club').dropdown('get value');            var club_info=str_club_info.split(",");            var club_id=club_info[0];            var club_account_id=club_info[1];            //var club_name=$('#club').dropdown('get text');            var account_id=$('#account').dropdown('get value');            var cash_num=$.trim($('#cash_num').val());            var cash_type=true;            var note=$.trim($('#note').val());            if(club_account_id != 'None') {                $.ajax({                    url: '/club_cash/',                    type: 'post',                    data: {                        'club_id': club_id,                        'account_id': account_id,                        'cash_num': cash_num,                        'cash_type': cash_type,                        'note': note                    },                    success: function (result_2) {                        if (result_2 === 'False') {                            $('#msg').text("账户余额不足，请确认后操作");                            $('#err_message').modal('show')                        }                        else {                            $('#msg2').text("结算成功");                            $('#message').modal('show');                            $('#union_balance').remove();                            $("#union_content").load("/union_balance_view/ #content", function (result) {                                $result = $(result);                                $result.find("script").appendTo('#content');                                $('#cash_num').val("");                                $('#note').val("");                            });                            $("#club_account").load("/club_account_info/");                        }                    }                })            }            else if(club_account_id==='None') {                //alert(club_account_id);                $.ajax({                    url:'/developer_balance_cash/',                    type:'post',                    data:{'developer_id':club_id,'chance':cash_num,'note':note,'type_id':2002,'account_id':account_id},                    success:function (result) {                        if(result==='True')                        {                            $('#msg2').text("结算成功");                            $('#message').modal('show');                            $('#union_balance').remove();                            $("#developer_content").load('/developer_balance_view/ #content',function (result) {                                $result = $(result);                                $result.find("script").appendTo('#content');                                $('#cash_num').val("");                                $('#note').val("");                            });                            $("#club_account").load("/club_account_info/");                        }                        else {                            $('#msg2').text("账户余额不足，请确认后操作");                            $('#message').modal('show');                        }                    }            })            }        }    }</script><script>    $('#cash_form').form({    on:'blur',    inline : true,    fields:{        cash_num:{          identifier :'cash_num',          rules:[{              type: 'empty',              prompt: '请输入金额'          },{              type:'regExp',              value : '/^(?!(0[0-9]{0,}$))[0-9]{1,}[.]{0,}[0-9]{0,}$/',              prompt:'请输入正数'          }          ]        },        account:{            identifier:'account',            rules:[                {                    type:'empty'                }            ]        },        club:{            identifier:'club',            rules:[                {                    type:'empty'                }            ]        }    }})</script><script>$('.ui.checkbox')  .checkbox()  .first().checkbox({    onChecked: function() {      $('#account_list').addClass("ui inverted red segment")    },        onUnchecked: function() {      $('#account_list').removeClass("ui inverted red segment")    }  });</script></body></html>