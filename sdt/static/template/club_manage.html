<!DOCTYPE html>{% load static %}<html lang="zh"><head>    <meta charset="UTF-8">    <title>俱乐部信息修改</title>    <link rel="stylesheet" href="{% static 'semantic/semantic.css'%}"><script src="http://lib.baomitu.com/jquery/1.12.4/jquery.min.js"></script><script src="http://lib.baomitu.com/semantic-ui/2.2.13/semantic.min.js"></script></head><body><div id="sidebar" ></div><div class="dimmed pusher"><div class="ui labeled icon button" id="menu">		<i class="sidebar icon"></i>		导航		</div>    <div class="ui doubling stackable container" style="padding: 50px">        <div class="ui five item inverted menu">		<a class="item" id="a">出纳台</a>		<a class="item" id="b">玩家管理</a>		<a class="item" id="c">牌局管理</a>		<a class="item" id="d">实时报表</a>		<a class="item" id="e">俱乐部管理</a>		</div>        <div class="ui small modal">        <h2 class="header">处理结果</h2>        <div class="content">            <p id="msg1"></p>        </div>        <div class="actions">            <button class="ui negative button" onclick="messageconfirm()">返回</button>        </div>        </div>        <div class="ui form" name="club_info" id="club_info" method="post">            <label for="club_list">搜索俱乐部</label>            <select class="ui search selection dropdown" name="club_list" id="club_list" onchange="search()">            <i class="search link icon"></i>            <option class="item" value="">点击搜索</option>            {% for t in tb_club_list %}            <option class="item" value={{ t.0 }}>{{ t.1 }}</option>            {% endfor %}            </select>        <h4 class="ui dividing pink header">用户信息修改</h4>            <div class="two fields">                <div class="field">                    <label>俱乐部名称</label>                <input type="text" name="club_name" id="club_name" >                </div>                    <div class="field">                    <label>俱乐部缩写</label>                <input type="text" name="club_shortname" id="club_shortname">                </div>            </div>            <div class="two fields">                <div class="field">                    <label>自身水钱比例</label>                <input type="text" name="water_rate" id="water_rate" >                </div>                    <div class="field">                    <label>自身保险比例</label>                <input type="text" name="insure_rate" id="insure_rate">                </div>            </div>            <div class="field">                <label>俱乐部描述</label>                <input type="text" name="club_desc" id="club_desc">            </div>            <div class="ui hidden divider"></div>            <button class="ui button primary" onclick="modify()">修改</button>            <button class="ui button negative">放弃</button>            <input type="hidden" id="o_club_name">            <input type="hidden" id="o_club_shortname">            <input type="hidden" id="o_water_rate">            <input type="hidden" id="o_insure_rate">            <input type="hidden" id="o_club_desc">        </div>      <div class="ui info message">            <div class="header">操作提示</div>            <ul class="list"></ul>                <li>修改比例后，未结束牌局会按照新配置生效</li>                <li>已结算牌局不会有影响</li>      </div>    </div></div><script>	$(document).ready(function(){        $('.ui.dropdown').dropdown();		$("#sidebar").load('/loadsidebar/');        $("#e").addClass('active red item');	}					 )            $("#menu").click(function(){            $('.ui.sidebar').sidebar('toggle');        })</script><script>    $('#club_info').form({    on:'blur',    inline:true,    fields:{        club_name:{            identifier:'club_name',            rules:[{                type:'empty',                prompt:'玩家名不能为空'            }]        },        club_shortname:{            identifier: 'club_shortname',            rules:[{                type:'empty',                prompt:'微信名不能为空'            }]        },        water_rate:{         identifier: 'water_rate',          rules:[              {                  type: 'regExp',                  value:'/^(0|[1-9]\\d?|100)$/',                  prompt:'请输入0-100整数'              }          ]      },       insure_rate:{         identifier: 'insure_rate',          rules:[              {                  type: 'regExp',                  value:'/^(0|[1-9]\\d?|100)$/',                  prompt:'请输入0-100整数'              }          ]      }    }})</script><script>    function search() {        var club_id=$('#club_list').dropdown('get value');        var club_name=$('#club_list').dropdown('get text');        $.ajax({            url : '/club_info/',            type: 'post',            data:{'club_id': club_id},            success: function (result) {                if (result!="False")                {                    var dic=[];                    $.each(JSON.parse(result), function (key,value) {                        dic[key]=value;                    })                    $('#club_name').val(dic['club_name']);                    $('#club_shortname').val(dic['club_shortname']);                    $('#water_rate').val(dic['income_rate']);                    $('#insure_rate').val(dic['insure_rate']);                    $('#club_desc').val(dic['club_desc']);                    $('#o_club_name').val(club_name);                    $('#o_club_shortname').val(dic['club_shortname']);                    $('#o_water_rate').val(dic['income_rate']);                    $('#o_insure_rate').val(dic['insure_rate']);                    $('#o_club_desc').val(dic['club_desc']);                }            }        })    }    function modify() {        //$.ajaxSetup({async: true});        var club_id=$('#club_list').dropdown('get value');        var club_name=$('#club_name').val();        var club_shortname=$('#club_shortname').val();        var water_rate=$('#water_rate').val();        var insure_rate=$('#insure_rate').val();        var club_desc=$('#club_desc').val();        var o_club_name=$('#o_club_name').val();        var o_club_shortname=$('#o_club_shortname').val();        var o_water_rate=$('#o_water_rate').val();        var o_insure_rate=$('#o_insure_rate').val();        var o_club_desc=$('#o_club_desc').val();        if (club_name===o_club_name && club_shortname===o_club_shortname &&            water_rate===o_water_rate && insure_rate===o_insure_rate && o_club_desc===club_desc)        {            $('#msg1').text("没有任何修改");            $('.ui.modal').modal('show');        }        else {            $.ajax({                url: '/modify_club/',                type: 'post',                data: {                    'club_id': club_id,                    'club_name': club_name,                    'club_shortname': club_shortname,                    'income_rate': water_rate,                    'insure_rate': insure_rate,                    'club_desc': club_desc                },                success: function (result) {                    if (result === 'False') {                        $('#msg1').text("修改失败");                        $('.ui.modal').modal('show');                    }                    else if (result === 'True') {                        $('#msg1').text("修改成功");                        $('.ui.modal').modal('show');                    }                }            })        }    }    function messageconfirm() {            location.reload();        }</script></body></html>