<!DOCTYPE html><html lang="zh"><head>    <meta charset="UTF-8">    <title>带入列表</title></head><body><div id="content">    <div class="ui form" name="freeze" id="freeze">        <div class="field">            <label>请选择玩家</label>            <select class="ui fluid search selection dropdown" name="user_list" id="user_list" onchange="getbalance()">                <i class="dropdown icon"></i>                <option class="item" value="">请选择玩家</option>                {% for t in tb_user %}                <option class="item"value={{ t.0 }},{{ t.1 }}>{{ t.2 }}</option>                {% endfor %}            </select>        </div>        <div class="field">            <label>可用余额</label>            <input type="text" readonly="true" name="balance_useful" id="balance_useful">        </div>        <div class="field">            <label>托管俱乐部可用余额</label>            <input type="text" readonly="true" name="developer_useful" id="developer_useful">        </div>        <div class="field">            <label>请输入带入金额</label>            <input type="text"  name="freeze_num" id="freeze_num">        </div>        <input type="hidden"  id="game_no" value={{ gameno }} >            <button class="ui mini button positive" id="reg_btn" onclick="reg_check()">带入</button>    </div><div id="freeze_list"></div><script>    $(document).ready(function () {        $('.ui.dropdown').dropdown();        var game_no=$('#game_no').text();        $('#freeze_list').load('/freeze_minilist/', {'game_no':game_no})    })</script><script>    function getbalance() {        var struserinfo=$("#user_list").dropdown('get value');        var user_info=struserinfo.split(",");        var account_id= user_info[1];        var user_id=user_info[0];        $.ajax({            url:'/getusefulbalance/',            type: 'post',            data:{'account_id': account_id,'user_id':user_id},            success: function (result) {                var dic=[];                $.each(JSON.parse(result),function (key,value) {                    dic[key]=value;                });                $('#balance_useful').val(dic['balance_useful']);                $('#developer_useful').val(dic['developer_useful'])            }        })    }    function reg() {        $.ajaxSetup ({ cache: true });        var flag=$("#freeze").form('is valid');        if (flag){            var struserinfo=$("#user_list").dropdown('get value');            var user_info=struserinfo.split(",");            var user_id=user_info[0];            var account_id= user_info[1];            var freeze_num=$.trim($('#freeze_num').val());            var game_no=$('#game_no').text();            $.ajax({                url: '/freeze_minilist/',                type: 'post',                data:{'user_id':user_id, 'account_id': account_id, 'freeze_num': freeze_num,'game_no':game_no },                success: function (result) {                    if(result==='False')                    {                        alert("上分失败")                    }                    else (result==='True')                    {                        $('#freeze_list').load('/freeze_minilist/', {'game_no':game_no});                        getbalance();                        $('#freeze_num').val("")                    }                }            })            }    }function reg_check() {    var freeze_num=$.trim($('#freeze_num').val());    var balance_useful=$('#balance_useful').val();    var developer_useful=$('#developer_useful').val();    if (parseInt(freeze_num)>(parseInt(balance_useful)+parseInt(developer_useful))){        $('#warning_message').text("可用余额不足，是否继续上分？");        //$('#warning').modal('attach events',$('#reg_btn'));        $('#warning').modal('show')    }    else {        reg()    }}</script><script>$('#freeze').form({    on:'blur',    inline : true,    fields: {        freeze_num: {            identifier: 'freeze_num',            rules: [{                type: 'empty',                prompt: '请输入预占用金额'            }, {                type: 'regExp',                value: '^(\\-|\\+)?\\d+(\\.\\d+)?$',                prompt: '请输入数字'            }            ]        }    }    })</script></div></body></html>