<!DOCTYPE html><!--{% load static %}--><html lang="en"><head>    <meta charset="UTF-8">    <title>玩家管理</title>    <!--<link rel="stylesheet" href="../semantic/semantic.min.css"> -->    <link rel="stylesheet" href="{% static 'semantic/semantic.css'%}"><script src="http://lib.baomitu.com/jquery/1.12.4/jquery.min.js"></script><script src="http://lib.baomitu.com/datatables/1.10.16/js/jquery.dataTables.min.js"></script><script src="http://lib.baomitu.com/datatables/1.10.16/js/dataTables.semanticui.min.js"></script><script src="http://lib.baomitu.com/semantic-ui/2.2.13/semantic.min.js"></script></head><body><div id="sidebar" ></div><div class="dimmed pusher"><div class="ui labeled icon button" id="menu">		<i class="sidebar icon"></i>		导航		</div>    <div class="ui doubling stackable container" style="padding: 50px">      <div class="ui five item inverted menu">		<a class="item" id="a">出纳台</a>		<a class="item" id="b">玩家管理</a>		<a class="item" id="c">牌局管理</a>		<a class="item" id="d">实时报表</a>		<a class="item" id="e">俱乐部管理</a>		</div>	<div class="ui horizontal divider">	玩家新增	</div>    <div class="ui doubling stackable grid">        <div class="row">           <div class="ui four wide column">               <div name="user_reg">               <h3 class="ui orange header">                <i class="add user icon"></i>                <div class="content">                        新增玩家                    <div class="sub orange header">新建本俱乐部玩家</div>                </div>                </h3>                       <div class="ui form"  method="post" id="userForm">  <div class="field">    <label for="user_name">玩家姓名</label>    <input id="user_name" type="text" name="user_name" placeholder="填游戏昵称">  </div>   <div class="field">    <label for="wx_name">微信名称</label>    <input id="wx_name" type="text" name="wx_name" placeholder="微信名">  </div>  <div class="field">  <label for="club_id">选择俱乐部</label>	<select  name="club_id" id="club_id" class="ui fluid search selection dropdown">    <i class="dropdown icon"></i>	  {% for t in tb_club %}		<option value={{ t.club_id }}>{{ t.club_name }}</option>	  {% endfor %}	</select>  </div>  <div class="field">    <label for="remark">别名</label>    <input type="text" name="note" id="remark" placeholder="设置别名">  </div><div class="field">    <label for="feedback">返水比例</label>    <input type="text" name="feedback" id="feedback" placeholder="不超过5%，例：返2.5%，填2.5">  </div>  <div class="field">    <label for="feedback_type">返水模式</label>    <select class="ui selected dropdown" id="feedback_type">        <option value='0'>水上水下返水</option>        <option value='1'>仅水上返水</option>    </select>  </div>  <button class="ui button mini primary" onclick="user_reg()">提交</button>  <button class="ui button right floated mini discard" type="reset" >重填</button><br>  <div class="ui error message">      </div>  </div>               </div>           </div>        <div class="ui twelve wide column" id="content">        </div>        </div>    </div>    </div>    <div class="ui small modal" id="message">        <h2 class="header">错误信息</h2>        <div class="content">            <p id="msg"></p>        </div>        <div class="actions">            <button class="ui negative button">返回</button>        </div>    </div>    <div class="ui small modal" id="message1">        <h2 class="header">确认信息</h2>        <div class="content">            <p id="msg1"></p>        </div>        <div class="actions">            <button class="ui primary button" onclick="oldreg()">确定</button>            <button class="ui negative button">返回</button>        </div>    </div>    <div class="ui small modal" id="message2">        <h2 class="header">确认信息</h2>        <div class="content">            <p id="msg2"></p>        </div>        <div class="actions">            <button class="ui negative button" onclick="confirm()">返回</button>        </div>    </div>    <div class="ui small modal" id="message3">        <h2 class="header">确认信息</h2>        <div class="content">            <p id="msg3"></p>        </div>        <div class="actions">            <button class="ui primary button" onclick="reg()">确定</button>            <button class="ui negative button" >返回</button>        </div>    </div></div><script>//边栏弹出	$("#menu").click(function(){		$('.ui.sidebar').sidebar('toggle');	});</script><script>//加载边栏，设置导航激活按钮    $(document).ready(function () {        $("#sidebar").load('/loadsidebar/')        $("#b").addClass('active red item');        var club_id=$('#club_id').val();        $.ajaxSetup({cache: false });        $("#content").load('/user_list/ #content',{'club_id':club_id}, function (result) {            $result=$(result);            $result.find("script").appendTo('#content');        })    })</script><script>    $.fn.form.settings.rules.check_feedback=function (feedback) {        if(parseFloat(feedback)<=5 && parseFloat(feedback)>=0)        {            return true        }        else {            return false        }    };</script>	<script>	$(document).ready(function() {    	var str_club_id;		str_club_id=$(".ui.dropdown").dropdown('get value');		$("#club_id").value=str_club_id;	});	</script><script>$('#userForm')  .form({    on: 'blur',    inline:true,    fields: {      user_name: {        identifier  : 'user_name',        rules: [          {            type   : 'empty',            prompt : '请填写玩家名称'          }        ]      },        feedback: {        identifier  : 'feedback',        rules: [          {            type   : 'regExp',            value : '^(\\+)?\\d+(\\.\\d+)?$',            prompt : '请输入正数'          },            {                type: 'check_feedback',                prompt:'请输入0-5之间数字'            }        ]      },    }});</script><script>    function user_reg() {        var user_name=$('#user_name').val();        var wx_name=$('#wx_name').val();        var note=$('#note').val();        var club_id=$('#club_id').dropdown('get value');        var club_name=$('#club_id').dropdown('get text');        var message=$("#userForm").form('is valid');        if (message)        {            $.ajax({                url:'/checkuser/',                type :'post',                data:{'user_name': user_name, 'club_id': club_id},                success: function (result) {                    var flag=result;                    switch (flag)                    {                        case "1":                            $('#msg').text("俱乐部存在同名玩家");                            $('#message').modal('show');                            break;                        case "2":                            $('#msg1').text("联盟中其他俱乐部存在同名玩家，是否继续添加该玩家");                            $('#message1').modal('show');                            break;                        case "0":                            var str="确认添加玩家:【"+user_name+"】到【"+club_name+"】吗？"                            $('#msg3').text(str);                            $('#message3').modal('show');                    }                }            })        }    }    function reg() {        var user_name=$.trim($('#user_name').val());        var wx_name=$.trim($('#wx_name').val());        var remark=$.trim($('#remark').val());        var club_id=$('#club_id').dropdown('get value');        var feedback=$.trim($('#feedback').val());        var feedback_type=$('#feedback_type').dropdown('get value');        if (feedback===""){            feedback=0        }        if (remark===""){            remark=user_name        }        if(wx_name===""){            wx_name=user_name        }        $.ajax({                url:'/user_add/',                type: 'post',                data:{'user_name':user_name, 'wx_name': wx_name, 'club_id': club_id,'remark':remark,'feedback':feedback,'feedback_type':feedback_type},                success: function (flag) {                    var result=flag                    if (result=="True")                    {                        $('#msg2').text("添加成功");                        $('#message2').modal('show');                    }                    else if(result=="False")                    {                        $('#msg2').text("添加失败");                        $('#message2').modal('show');                    }                }            })    }    function confirm() {        location.reload();    }    function oldreg() {        $.ajaxSetup({async: false});        var user_name=$.trim($('#user_name').val());        var club_id=$('#club_id').dropdown('get value');        var remark=$.trim($('#remark').val());        var feedback=$.trim($('#feedback').val());        var feedback_type=$('#feedback_type').dropdown('get value');        if (feedback===""){            feedback=0        }        if (remark===""){            remark=user_name        }        $.ajax({            url:"/old_user_add/",            type: 'post',            data:{'user_name':user_name,'club_id':club_id,'remark':remark,'feedback':feedback,'feedback_type':feedback_type},            success : function (result) {                var flag=result;                if (flag=="True")                    {                        $('#msg2').text("添加成功");                        $('#message2').modal('show');                        location.reload();                    }                    else if(flag=="False")                    {                        $('#msg2').text("添加失败");                        $('#message2').modal('show');                    }            }        })    }</script></body></html>